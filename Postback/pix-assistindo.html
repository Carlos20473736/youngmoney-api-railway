<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pix Assistindo Manager</title>

    <!-- Telegram Web App SDK - OFICIAL -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- VERIFICA√á√ÉO DO USER_ID NA URL -->
    <script>
    (function() {
        'use strict';

        // Fun√ß√£o para obter par√¢metro da URL
        function getUrlParam(param) {
            var urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Verificar se user_id est√° presente na URL
        function hasValidUserId() {
            var userId = getUrlParam('user_id');
            // user_id deve existir e ser um n√∫mero v√°lido (ID do Telegram)
            return userId && userId.length > 0 && /^[0-9]+$/.test(userId);
        }

        // Armazenar user_id globalmente para uso posterior
        window.TELEGRAM_USER_ID = getUrlParam('user_id');

        function showBlockScreen() {
            document.documentElement.innerHTML = '<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Acesso Bloqueado</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,sans-serif;background:linear-gradient(135deg,#0a0e1a 0%,#0d1225 100%);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}.container{max-width:380px;text-align:center;animation:fadeIn .6s ease}.icon{width:100px;height:100px;margin:0 auto 25px;background:linear-gradient(135deg,#0088cc,#00a8e8);border-radius:24px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 40px rgba(0,136,204,.3)}.icon svg{width:60px;height:60px;fill:#fff}h1{font-size:1.5rem;margin-bottom:12px;font-weight:700}p{color:#a0aec0;margin-bottom:30px;line-height:1.6}.card{background:rgba(20,25,45,.9);border:1px solid rgba(139,92,246,.3);border-radius:16px;padding:25px;margin-bottom:20px;text-align:left}.step{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px;color:#a0aec0;font-size:.95rem;line-height:1.5}.step:last-child{margin-bottom:0}.num{min-width:28px;height:28px;background:linear-gradient(135deg,#8b5cf6,#00ddff);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.85rem;color:#fff}.warn{display:flex;align-items:center;justify-content:center;gap:10px;padding:15px;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:12px;color:#ef4444;font-size:.9rem}.warn svg{width:20px;height:20px;fill:currentColor;flex-shrink:0}@keyframes fadeIn{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}</style></head><body><div class="container"><div class="icon"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/></svg></div><h1>Acesso Exclusivo</h1><p>Entre pelo Telegram</p><div class="card"><div class="step"><span class="num">1</span><span>Abra o <strong>Telegram</strong> no seu celular</span></div><div class="step"><span class="num">2</span><span>Acesse o <strong>bot oficial</strong> do YoungMoney</span></div><div class="step"><span class="num">3</span><span>Clique no bot√£o para abrir o <strong>Mini App</strong></span></div></div><div class="warn"><svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg><span>Acesso requer user_id v√°lido na URL</span></div></div></body></html>';
        }

        // Verificar imediatamente se user_id est√° presente
        if (!hasValidUserId()) {
            showBlockScreen();
        }
    })();
    </script>
    <link rel="stylesheet" href="pix-style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#10b981">
    <meta name="description" content="Gerenciador de saldo e miss√µes para o sistema Pix Assistindo">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%2310b981'/%3E%3Ctext x='50' y='60' text-anchor='middle' fill='white' font-size='40' font-family='Arial'%3EP%3C/text%3E%3C/svg%3E">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üí∞</div>
                    <h1>Pix Assistindo Manager</h1>
                </div>
                <div class="status-indicator">
                    <div id="statusDot" class="status-dot stopped"></div>
                    <span id="statusText" class="status-text">Parado</span>
                </div>
                <div class="timer-display" style="background: rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 12px; margin-left: 16px;">
                    <span style="font-size: 14px; opacity: 0.8;">Tempo de Uso:</span>
                    <span id="sessionTimer" style="font-size: 18px; font-weight: bold; margin-left: 8px;">00:00:00</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Configuration Panel -->
            <section class="config-panel">
                <h2>Configura√ß√£o</h2>
                <div class="form-group">
                    <label for="email">E-mail do Usu√°rio:</label>
                    <input type="email" id="email" placeholder="Ex: usuario@email.com" required>
                </div>
                <div class="form-group">
                    <label for="tipoAnuncio">Tipo de An√∫ncio:</label>
                    <select id="tipoAnuncio" class="select-input">
                        <option value="rewarded">An√∫ncio Recompensado</option>
                        <option value="interstitial">An√∫ncio Intersticial</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="interval">Intervalo (segundos):</label>
                    <div class="slider-container">
                        <input type="range" id="interval" min="60" max="300" value="60" step="10">
                        <span id="intervalValue" class="slider-value">60</span>
                    </div>
                </div>
                <div class="control-buttons">
                    <button id="startBtn" class="btn btn-primary">
                        <span class="btn-icon">‚ñ∂Ô∏è</span>
                        Iniciar Simula√ß√£o
                    </button>
                    <button id="stopBtn" class="btn btn-secondary" disabled>
                        <span class="btn-icon">‚èπÔ∏è</span>
                        Parar
                    </button>
                    <button id="clearBtn" class="btn btn-outline">
                        <span class="btn-icon">üóëÔ∏è</span>
                        Limpar Log
                    </button>

                </div>
            </section>

            <!-- Stats Panel -->
            <section class="stats-panel">
                <h2>Estat√≠sticas</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-content">
                            <div class="stat-value" id="requestCount">0</div>
                            <div class="stat-label">An√∫ncios Assistidos</div>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <div class="stat-value" id="successCount">0</div>
                            <div class="stat-label">Sucessos</div>
                        </div>
                    </div>
                    <div class="stat-card error">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-content">
                            <div class="stat-value" id="errorCount">0</div>
                            <div class="stat-label">Erros</div>
                        </div>
                    </div>
                    <div class="stat-card money">
                        <div class="stat-icon">üíµ</div>
                        <div class="stat-content">
                            <div class="stat-value" id="totalEarnings">R$ 0,00</div>
                            <div class="stat-label">Total Ganho</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- User Info Panel -->
            <section class="user-info-panel">
                <h2>Informa√ß√µes do Usu√°rio</h2>
                <div id="userInfoContainer" class="user-info-container">
                    <div class="user-info-empty">
                        <span class="empty-icon">üë§</span>
                        <p>Execute uma consulta para ver as informa√ß√µes do usu√°rio</p>
                    </div>
                </div>
            </section>

            <!-- Mission Progress Panel -->
            <section class="mission-panel">
                <h2>Progresso da Miss√£o</h2>
                <div id="missionContainer" class="mission-container">
                    <div class="mission-empty">
                        <span class="empty-icon">üéØ</span>
                        <p>Dados da miss√£o aparecer√£o aqui ap√≥s a primeira consulta</p>
                    </div>
                </div>
            </section>

            <!-- Rewards Config Panel -->
            <section class="rewards-panel">
                <h2>Configura√ß√µes de Recompensa</h2>
                <div id="rewardsContainer" class="rewards-container">
                    <div class="rewards-empty">
                        <span class="empty-icon">‚öôÔ∏è</span>
                        <p>Carregando configura√ß√µes de recompensa...</p>
                    </div>
                </div>
            </section>

            <!-- Log Panel -->
            <section class="log-panel">
                <div class="log-header">
                    <h2>Log de Atividades</h2>
                    <button id="autoScrollBtn" class="btn btn-small active">Auto Scroll</button>
                </div>
                <div id="logContainer" class="log-container">
                    <div class="log-empty">
                        <span class="log-empty-icon">üìù</span>
                        <p>Clique em "Iniciar Simula√ß√£o" para come√ßar a assistir an√∫ncios</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="session-security.js"></script>
    <script src="pix-script.js"></script>
</body>
</html>

