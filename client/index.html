<!doctype html>
<html lang="pt-BR">

  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#0a0e27" />
    <meta name="description" content="YoungMoney Tasks - Complete tarefas e ganhe recompensas" />
    <title>YoungMoney Tasks</title>
    
    <!-- Google Fonts: Space Grotesk + Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@500;600&display=swap" rel="stylesheet" />
    
    <!-- Telegram Web App SDK - OFICIAL -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- VERIFICAÇÃO DO USER_ID NA URL -->
    <script>
    (function() {
        'use strict';

        // Função para obter parâmetro da URL
        function getUrlParam(param) {
            var urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Verificar se user_id está presente na URL
        function hasValidUserId() {
            var userId = getUrlParam('user_id');
            // user_id deve existir e ser um número válido (ID do Telegram)
            return userId && userId.length > 0 && /^[0-9]+$/.test(userId);
        }

        // Armazenar user_id globalmente para uso posterior
        window.TELEGRAM_USER_ID = getUrlParam('user_id');

        function showBlockScreen() {
            document.documentElement.innerHTML = '<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Acesso Bloqueado</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,sans-serif;background:linear-gradient(135deg,#0a0e1a 0%,#0d1225 100%);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}.container{max-width:380px;text-align:center;animation:fadeIn .6s ease}.icon{width:100px;height:100px;margin:0 auto 25px;background:linear-gradient(135deg,#0088cc,#00a8e8);border-radius:24px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 40px rgba(0,136,204,.3)}.icon svg{width:60px;height:60px;fill:#fff}h1{font-size:1.5rem;margin-bottom:12px;font-weight:700}p{color:#a0aec0;margin-bottom:30px;line-height:1.6}.card{background:rgba(20,25,45,.9);border:1px solid rgba(139,92,246,.3);border-radius:16px;padding:25px;margin-bottom:20px;text-align:left}.step{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px;color:#a0aec0;font-size:.95rem;line-height:1.5}.step:last-child{margin-bottom:0}.num{min-width:28px;height:28px;background:linear-gradient(135deg,#8b5cf6,#00ddff);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.85rem;color:#fff}.warn{display:flex;align-items:center;justify-content:center;gap:10px;padding:15px;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:12px;color:#ef4444;font-size:.9rem}.warn svg{width:20px;height:20px;fill:currentColor;flex-shrink:0}@keyframes fadeIn{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}</style></head><body><div class="container"><div class="icon"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/></svg></div><h1>Acesso Exclusivo</h1><p>Entre pelo Telegram</p><div class="card"><div class="step"><span class="num">1</span><span>Abra o <strong>Telegram</strong> no seu celular</span></div><div class="step"><span class="num">2</span><span>Acesse o <strong>bot oficial</strong> do YoungMoney</span></div><div class="step"><span class="num">3</span><span>Clique no botão para abrir o <strong>Mini App</strong></span></div></div><div class="warn"><svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg><span>Acesso requer user_id válido na URL</span></div></div></body></html>';
        }

        // Verificar imediatamente se user_id está presente
        if (!hasValidUserId()) {
            showBlockScreen();
        }
    })();
    </script>

    <script>
        // Criar simulação se o SDK oficial não funcionar
        window.addEventListener('DOMContentLoaded', function() {
            const now = Math.floor(Date.now() / 1000);
            const userId = 1000000000 + Math.floor(Math.random() * 1000000000);

            // Verificar se o Telegram.WebApp foi carregado corretamente
            if (!window.Telegram || !window.Telegram.WebApp || !window.Telegram.WebApp.initDataUnsafe || !window.Telegram.WebApp.initDataUnsafe.user) {
                console.log('⚠️ SDK oficial do Telegram não forneceu dados, criando simulação...');

                // Criar objeto Telegram se não existir
                if (!window.Telegram) {
                    window.Telegram = {};
                }

                // Criar ou completar WebApp
                window.Telegram.WebApp = {
                    initData: `query_id=AAHdF6IQAAAAAN0XohDhrOrc&user=%7B%22id%22%3A${userId}%2C%22first_name%22%3A%22User%22%2C%22last_name%22%3A%22Test%22%2C%22username%22%3A%22testuser%22%2C%22language_code%22%3A%22pt%22%2C%22allows_write_to_pm%22%3Atrue%7D&auth_date=${now}&hash=abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890`,
                    initDataUnsafe: {
                        query_id: 'AAHdF6IQAAAAAN0XohDhrOrc',
                        user: {
                            id: userId,
                            first_name: 'User',
                            last_name: 'Test',
                            username: 'testuser',
                            language_code: 'pt',
                            allows_write_to_pm: true,
                            is_premium: false
                        },
                        auth_date: now,
                        hash: 'abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890'
                    },
                    version: '7.0',
                    platform: 'android',
                    colorScheme: 'light',
                    themeParams: {
                        bg_color: '#ffffff',
                        text_color: '#000000',
                        hint_color: '#999999',
                        link_color: '#2481cc',
                        button_color: '#2481cc',
                        button_text_color: '#ffffff',
                        secondary_bg_color: '#f1f1f1'
                    },
                    isExpanded: true,
                    viewportHeight: window.innerHeight,
                    viewportStableHeight: window.innerHeight,
                    headerColor: '#ffffff',
                    backgroundColor: '#ffffff',
                    isClosingConfirmationEnabled: false,
                    ready: function() {
                        console.log('✅ Telegram.WebApp.ready()');
                    },
                    expand: function() {
                        console.log('✅ Telegram.WebApp.expand()');
                    },
                    close: function() {
                        console.log('✅ Telegram.WebApp.close()');
                    },
                    MainButton: {
                        text: 'CONTINUAR',
                        color: '#2481cc',
                        textColor: '#ffffff',
                        isVisible: false,
                        isActive: true,
                        setText: function(text) { this.text = text; },
                        onClick: function(callback) { },
                        show: function() { this.isVisible = true; },
                        hide: function() { this.isVisible = false; }
                    },
                    BackButton: {
                        isVisible: false,
                        show: function() { this.isVisible = true; },
                        hide: function() { this.isVisible = false; }
                    },
                    HapticFeedback: {
                        impactOccurred: function(style) { },
                        notificationOccurred: function(type) { },
                        selectionChanged: function() { }
                    },
                    sendData: function(data) {
                        console.log('Telegram.WebApp.sendData:', data);
                    }
                };

                console.log('✅ Ambiente Telegram simulado criado');
            } else {
                console.log('✅ SDK oficial do Telegram funcionando');
            }

            console.log('User ID:', window.Telegram.WebApp.initDataUnsafe.user.id);
        });
    </script>
    
    <style>
      /* Font families */
      :root {
        --font-display: 'Space Grotesk', sans-serif;
        --font-body: 'Inter', sans-serif;
        --font-mono: 'JetBrains Mono', monospace;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script
      defer
      src="%VITE_ANALYTICS_ENDPOINT%/umami"
      data-website-id="%VITE_ANALYTICS_WEBSITE_ID%"></script>
  </body>

</html>
